{"ast":null,"code":"var _jsxFileName = \"/Users/harshkumar/Documents/bodymap/src/contexts/AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/contexts/AuthContext.js\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { supabase } from '../lib/supabase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext({});\nexport const useAuth = () => {\n  _s();\n  return useContext(AuthContext);\n};\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [therapist, setTherapist] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    supabase.auth.getSession().then(({\n      data: {\n        session\n      }\n    }) => {\n      if (session !== null && session !== void 0 && session.user) {\n        setUser(session.user);\n        supabase.from('therapists').select('*').eq('id', session.user.id).single().then(({\n          data\n        }) => {\n          if (data) setTherapist(data);\n        }).finally(() => setLoading(false));\n      } else {\n        setLoading(false);\n      }\n    }).catch(() => setLoading(false));\n    const {\n      data: {\n        subscription\n      }\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      if (session !== null && session !== void 0 && session.user) {\n        setUser(session.user);\n        supabase.from('therapists').select('*').eq('id', session.user.id).single().then(({\n          data\n        }) => {\n          if (data) setTherapist(data);\n        });\n      } else {\n        setUser(null);\n        setTherapist(null);\n      }\n    });\n    return () => subscription.unsubscribe();\n  }, []);\n  const signIn = async (email, password) => {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.auth.signInWithPassword({\n        email,\n        password\n      });\n      if (error) throw error;\n      setUser(data.user);\n      const {\n        data: t\n      } = await supabase.from('therapists').select('*').eq('id', data.user.id).single();\n      if (t) setTherapist(t);\n      return {\n        success: true\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n  const signOut = async () => {\n    await supabase.auth.signOut();\n    setUser(null);\n    setTherapist(null);\n    window.location.href = '/login';\n  };\n  const signUp = async (email, password, metadata) => {\n    try {\n      const {\n        data: authData,\n        error: authError\n      } = await supabase.auth.signUp({\n        email,\n        password\n      });\n      if (authError) throw authError;\n      const {\n        error: dbError\n      } = await supabase.from('therapists').insert([{\n        id: authData.user.id,\n        email,\n        business_name: metadata.businessName,\n        full_name: metadata.fullName,\n        phone: metadata.phone,\n        custom_url: metadata.customUrl,\n        password_hash: 'managed_by_supabase_auth',\n        plan: 'free'\n      }]);\n      if (dbError) throw dbError;\n      return {\n        success: true\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n  const updateProfile = async updates => {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('therapists').update(updates).eq('id', user.id).select().single();\n      if (error) throw error;\n      setTherapist(data);\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      therapist,\n      loading,\n      signIn,\n      signOut,\n      signUp,\n      updateProfile,\n      isAuthenticated: !!user\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"/3DwSFWmtT+xnmHbfsW/XJdTNRE=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","supabase","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","user","setUser","therapist","setTherapist","loading","setLoading","auth","getSession","then","data","session","from","select","eq","id","single","finally","catch","subscription","onAuthStateChange","_event","unsubscribe","signIn","email","password","error","signInWithPassword","t","success","message","signOut","window","location","href","signUp","metadata","authData","authError","dbError","insert","business_name","businessName","full_name","fullName","phone","custom_url","customUrl","password_hash","plan","updateProfile","updates","update","Provider","value","isAuthenticated","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/harshkumar/Documents/bodymap/src/contexts/AuthContext.js"],"sourcesContent":["// src/contexts/AuthContext.js\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { supabase } from '../lib/supabase';\n\nconst AuthContext = createContext({});\nexport const useAuth = () => useContext(AuthContext);\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [therapist, setTherapist] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      if (session?.user) {\n        setUser(session.user);\n        supabase.from('therapists').select('*').eq('id', session.user.id).single()\n          .then(({ data }) => { if (data) setTherapist(data); })\n          .finally(() => setLoading(false));\n      } else {\n        setLoading(false);\n      }\n    }).catch(() => setLoading(false));\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\n      if (session?.user) {\n        setUser(session.user);\n        supabase.from('therapists').select('*').eq('id', session.user.id).single()\n          .then(({ data }) => { if (data) setTherapist(data); });\n      } else {\n        setUser(null);\n        setTherapist(null);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const signIn = async (email, password) => {\n    try {\n      const { data, error } = await supabase.auth.signInWithPassword({ email, password });\n      if (error) throw error;\n      setUser(data.user);\n      const { data: t } = await supabase.from('therapists').select('*').eq('id', data.user.id).single();\n      if (t) setTherapist(t);\n      return { success: true };\n    } catch (error) {\n      return { success: false, error: error.message };\n    }\n  };\n\n  const signOut = async () => {\n    await supabase.auth.signOut();\n    setUser(null);\n    setTherapist(null);\n    window.location.href = '/login';\n  };\n\n  const signUp = async (email, password, metadata) => {\n    try {\n      const { data: authData, error: authError } = await supabase.auth.signUp({ email, password });\n      if (authError) throw authError;\n      const { error: dbError } = await supabase.from('therapists').insert([{\n        id: authData.user.id, email,\n        business_name: metadata.businessName,\n        full_name: metadata.fullName,\n        phone: metadata.phone,\n        custom_url: metadata.customUrl,\n        password_hash: 'managed_by_supabase_auth',\n        plan: 'free'\n      }]);\n      if (dbError) throw dbError;\n      return { success: true };\n    } catch (error) {\n      return { success: false, error: error.message };\n    }\n  };\n\n  const updateProfile = async (updates) => {\n    try {\n      const { data, error } = await supabase.from('therapists').update(updates).eq('id', user.id).select().single();\n      if (error) throw error;\n      setTherapist(data);\n      return { success: true, data };\n    } catch (error) {\n      return { success: false, error: error.message };\n    }\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, therapist, loading, signIn, signOut, signUp, updateProfile, isAuthenticated: !!user }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}